<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Java Lab Grade Calculator</title>
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —à—Ä–∏—Ñ—Ç -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        /* –û—Å–Ω–æ–≤–Ω–æ–π —Å—Ç–∏–ª—å —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5; /* –°–≤–µ—Ç–ª—ã–π —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–æ–Ω */
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 40px 20px;
            margin: 0;
            color: #333;
        }

        h1 {
            margin-bottom: 20px;
            color: #2c3e50;
        }

        /* –ö–∞—Ä—Ç–æ—á–∫–∞ –¥–ª—è —Ñ–æ—Ä–º—ã */
        .form-card {
            background-color: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            width: 100%;
            max-width: 400px;
            margin-bottom: 30px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–æ–ª–µ–π –≤–≤–æ–¥–∞ */
        .input-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            font-size: 14px;
            color: #555;
        }

        input[type="text"], input[type="number"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            box-sizing: border-box; /* –ß—Ç–æ–±—ã padding –Ω–µ –ª–æ–º–∞–ª —à–∏—Ä–∏–Ω—É */
            transition: border-color 0.3s;
        }

        input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }

        /* –ö–Ω–æ–ø–∫–∞ */
        button {
            width: 100%;
            padding: 14px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s;
            margin-top: 10px;
        }

        button:hover {
            background-color: #2980b9;
        }

        button:active {
            transform: scale(0.98);
        }

        /* –ë–ª–æ–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ */
        #currentResult {
            font-size: 18px;
            font-weight: bold;
            color: #27ae60;
            margin-bottom: 20px;
            text-align: center;
            min-height: 24px;
        }

        hr {
            width: 100%;
            max-width: 600px;
            border: 0;
            height: 1px;
            background: #ddd;
            margin: 30px 0;
        }

        /* –¢–∞–±–ª–∏—Ü–∞ */
        h3 {
            color: #2c3e50;
        }

        .table-wrapper {
            width: 100%;
            max-width: 800px;
            overflow-x: auto; /* –ù–∞ —Å–ª—É—á–∞–π –µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –Ω–µ –≤–ª–µ–∑–∞–µ—Ç –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–º */
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #f0f0f0;
        }

        th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #555;
            text-transform: uppercase;
            font-size: 12px;
            letter-spacing: 0.5px;
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr:hover {
            background-color: #fcfcfc;
        }

    </style>
</head>
<body onload="loadHistory()">

<h1>üéì –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –û—Ü–µ–Ω–∫–∏</h1>

<!-- –û–±–µ—Ä–Ω—É–ª–∏ —Ñ–æ—Ä–º—É –≤ –∫—Ä–∞—Å–∏–≤—É—é –∫–∞—Ä—Ç–æ—á–∫—É -->
<div class="form-card">
    <div class="input-group">
        <label for="name">–ò–º—è —Å—Ç—É–¥–µ–Ω—Ç–∞:</label>
        <input type="text" id="name" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è">
    </div>

    <div class="input-group">
        <label for="s1">–û—Ü–µ–Ω–∫–∞ 1 (–ö–†-1):</label>
        <input type="number" id="s1" placeholder="0-10">
    </div>

    <div class="input-group">
        <label for="s2">–û—Ü–µ–Ω–∫–∞ 2 (–ö–†-2):</label>
        <input type="number" id="s2" placeholder="0-10">
    </div>

    <div class="input-group">
        <label for="s3">–û—Ü–µ–Ω–∫–∞ 3 (–õ–∞–±—ã):</label>
        <input type="number" id="s3" placeholder="0-10">
    </div>

    <div class="input-group">
        <label for="s4">–û—Ü–µ–Ω–∫–∞ 4 (–¢–µ—Å—Ç–∏–∫):</label>
        <input type="number" id="s4" placeholder="0-10">
    </div>

    <button onclick="calculate()">–†–ê–°–°–ß–ò–¢–ê–¢–¨ –ò –°–û–•–†–ê–ù–ò–¢–¨</button>
</div>

<h3>–¢–µ–∫—É—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</h3>
<div id="currentResult"></div>

<hr>

<h3>üèÜ –ò—Å—Ç–æ—Ä–∏—è –æ—Ü–µ–Ω–æ–∫ (–¢–æ–ø —Å—Ç—É–¥–µ–Ω—Ç–æ–≤):</h3>
<div class="table-wrapper">
    <table>
        <thead>
        <tr>
            <th>ID</th>
            <th>–ò–º—è</th>
            <th>–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª</th>
            <th>–í–µ—Ä–¥–∏–∫—Ç</th>
        </tr>
        </thead>
        <tbody id="historyTable">
        <!-- –°—é–¥–∞ JavaScript –±—É–¥–µ—Ç –≤—Å—Ç–∞–≤–ª—è—Ç—å —Å—Ç—Ä–æ–∫–∏ -->
        </tbody>
    </table>
</div>

<!-- –¢–í–û–ô JS –ö–û–î –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô -->
<script>
    async function calculate() {
        const data = {
            name: document.getElementById('name').value,
            score1: parseInt(document.getElementById('s1').value) || 0,
            score2: parseInt(document.getElementById('s2').value) || 0,
            score3: parseInt(document.getElementById('s3').value) || 0,
            score4: parseInt(document.getElementById('s4').value) || 0
        };

        const response = await fetch('/api/calculate', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });

        if (response.ok) {
            const result = await response.json();

            document.getElementById('currentResult').innerText =
                "–°—Ç—É–¥–µ–Ω—Ç: " + result.name + " | –°—Ä–µ–¥–Ω–µ–µ: " + result.average + " | " + result.finalVerdict;

            loadHistory();
        } else {
            alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏!");
        }
    }

    async function loadHistory() {
        const response = await fetch('/api/history');
        let data = await response.json();

        data.sort((a, b) => b.average - a.average);

        const tableBody = document.getElementById('historyTable');
        tableBody.innerHTML = ""; // –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ —Å—Ç—Ä–æ–∫–∏

        data.forEach(student => {
            const row = `<tr>
                <td>${student.id}</td>
                <td>${student.name}</td>
                <td>${student.average}</td>
                <td>${student.finalVerdict}</td>
            </tr>`;
            tableBody.innerHTML += row;
        });
    }
</script>
</body>
</html>